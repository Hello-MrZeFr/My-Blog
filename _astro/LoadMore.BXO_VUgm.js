import{d as E,c as a,e as p,g as u,i as w,r as x,S,t as f}from"./web.lwOEWoHh.js";import{t as n}from"./toast.DnZCaRcI.js";import"./store.CIaw0Jax.js";var $=f('<button class="btn btn-wide bg-base-100 font-serif">'),L=f('<button class="btn btn-wide font-serif">已加载全部文章');const C=t=>{const[g,o]=a(!1),[r,m]=a(t.currentPage),[b,s]=a(!t.next),c=()=>r()*t.size<t.total;async function h(){if(!t.next||!c()){s(!0);return}o(!0);try{const e=await fetch(`/${r()+1}`);if(!e.ok){n.error("加载失败");return}const y=await e.text(),i=new DOMParser().parseFromString(y,"text/html").querySelector("[data-article-list]");if(!i){n.error("解析内容失败");return}const l=document.querySelector("[data-article-list]");l&&Array.from(i.childNodes).forEach(d=>{d.nodeType===Node.ELEMENT_NODE&&l.appendChild(d)}),m(r()+1),c()||s(!0)}catch(e){console.error("加载更多文章失败",e),n.error("加载失败")}finally{o(!1)}}return p(S,{get when(){return!b()},get fallback(){return u(L)},get children(){var e=u($);return e.$$click=h,w(e,()=>g()?"加载中...":"加载更多文章"),x(),e}})};E(["click"]);export{C as default};
